{"version":1,"windowDimensions":{"x":4,"y":23,"width":952,"height":1027,"maximized":false},"grammars":{"grammarOverridesByPath":{}},"project":{"deserializer":"Project","paths":["/home/sguenther/Templates/plot_templates/gnuplot/tikz/testing"],"buffers":[{"text":"%\n% THE BEER-WARE LICENSE (Rev. 42):\n% Ronny Bergmann <bergmann@math.uni-luebeck.de> wrote this file. As long as you\n% retain this notice you can do whatever you want with this stuff. If we meet\n% some day, and you think this stuff is worth it, you can buy me a beer or\n% coffee in return.\n\\pdfminorversion=4\n\n\\documentclass[draft, 10pt,xcolor=colortbl,compress\n%,draft\n]{beamer}\n\n\n\n\\usepackage[utf8]{inputenc}\n\\usepackage[OT1]{fontenc}\n\\usepackage{calc}\n%\\usepackage[ngerman]{babel} % Neue Rechtschreibung\n\\usepackage{amsmath,amsthm,amssymb,euscript} % AMS-LaTeX\n\\usepackage{enumerate,graphicx}\n\\usepackage{mathtools}\n% Load Theme\n\\usetheme[nometa,navigation=true, FB=None, frametotal=true]{TUKL}\n%\n\\setbeamertemplate{navigation symbols}{}\n\n\n\n\\newcommand{\\by}{\\bar y}\n\\newcommand{\\partiell}[2]{\\frac{\\partial{#1}}{\\partial{#2}}}\n\\newcommand{\\bluetext}[1]{{\\color{tuklblue}#1}}\n\n\\newcommand{\\beginbackup}{\n   \\newcounter{framenumbervorappendix}\n   \\setcounter{framenumbervorappendix}{\\value{framenumber}}\n}\n\\newcommand{\\backupend}{\n   \\addtocounter{framenumbervorappendix}{-\\value{framenumber}}\n   \\addtocounter{framenumber}{\\value{framenumbervorappendix}}\n}\n\n\\renewcommand{\\vec}[1]{\\boldsymbol{#1}}\n\n\n\\title{Simultaneous PDE-constrained Optimization in Chaotic Dynamics}\n%\\subtitle{Untertitel}\n\\date[]{03/10/16\\\\[1ex] Joint DMV and GAMM Annual Meeting 2016}\n\\author[Stefanie G\\\"unther et al.]{\\underline{Stefanie G{\\\"u}nther}$^*$, Nicolas R. Gauger$^*$, Qiqi Wang$^{\\diamond}$}\n\\institute[]{$^*$AG Scientific Computing, TU Kaiserslautern $|$ Germany \\\\ $^{\\diamond}$Department of Aeronautics and Astronautics, MIT Cambridge $|$ USA }\n%Setze ein Logo auf der Titelseite unten rechts\n%\\renewcommand{\\theSecondLogo}{\\includegraphics[scale=0.2]{logos/dmv-gamm-2016.pdf}}\n\n\n\\begin{document}\n\t\\maketitle\n\n  \\tableofcontents\n\n%############################################################################\n\\section{Simultaneous Optimization}\n%############################################################################\n\n\n\\begin{frame}{PDE-constrained Optimization}\n\n\t\\begin{align*}\n\t\t \\min_{y,u} \\, f(y,u) \\quad  s.t. \\quad c(y,u)=0\n\t\\end{align*}\\vspace{-1ex}\n\t\\begin{itemize}\n\t\t\\item $y$ - state variables, $u$ - design variables\n\t \t\\item Regularity: $\\frac{\\partial c}{\\partial y}$ is invertible\n\n  \t\\item First order optimality conditions %KKT-system with $L(y,\\bar y,u) :=f(y,u)+(G(y,u)-y)^T\\bar y $:\n  \t\t\\begin{align*}\n  \t\t\\begin{array}{l}   0 =c(y,u) \\\\ 0 = \\nabla_y f(y,u) + c_y(y,u)^T\\by \\\\ 0= \\nabla_u f(y,u) + c_u(y,u)^T \\by \\end{array} %\\right.\n  \t\t\\quad\n  \t\t\\begin{array}{l}  \\text{\\bluetext{State Equation}}\\\\ \\text{\\bluetext{Adjoint Equation}} \\\\ \\text{\\bluetext{Design Equation}} \t\t\t\t\t\\end{array}\n  \t\t\\end{align*}\n\n\t\\end{itemize}\n\n\\end{frame}\n\n\n\\begin{frame}{Nested vs Simultaneous Optimization}\n  Show the idea in a graphic! Still use $c$, not $G$.\n  \\begin{itemize}\n    \\item Nested Optimization\n    \\item Simultaneous Optimization\n  \\end{itemize}\n\\end{frame}\n\n\\begin{frame}{One-shot Optimization}\n  \\begin{itemize}\n    \\item One-shot optimization makes use of existing code\n    \\item Steady-state example (Emre)\n  \\end{itemize}\n\\end{frame}\n\n\n\n%############################################################################\n\\section{Chaotic Dynamics}\n%############################################################################\n\n\\begin{frame}{Chaotic Dynamics}\n  \\begin{itemize}\n    \\item some figures\n    \\item existing codes and dual time stepping\n    \\item Optimization problem with unsteady PDE constraints (discrete)\n  \\end{itemize}\n\\end{frame}\n\n\n\\begin{frame}{Simultaneous optimization with INITIAL VALUE PROBLEM}\n  \\begin{itemize}\n    \\item KKT condition\n    \\item Solve time stepping inexact at each time step\n  \\end{itemize}\n\n\\end{frame}\n\n\n\\begin{frame}{PROBLEM}\n  \\begin{itemize}\n    \\item Figures:\n      \\begin{itemize}\n        \\item Residuals over time\n        \\item Linear dependence of number of time steps\n      \\end{itemize}\n  \\end{itemize}\n\\end{frame}\n\n\n\\begin{frame}{Butterfly effect}\n  \\begin{itemize}\n    \\item Explain butterfly effect\n    \\item Use Lorenz example\n    \\item Relax the initial condition!\n  \\end{itemize}\n\n\\end{frame}\n\n%##############################################################################\n\\section{Relaxing the unsteady constraints / the initial condition}\n%##############################################################################\n\\begin{frame}{Remedy: Relax the initial condition}\n\n  \t\\begin{itemize}\n  \t\t%\\item Relax initial condition, enforce PDE only.\n  \t\t%\\item Costfunction is independent of initial condition%(Ergodic mean assumption)\n  \t\t%\\item State must satisfy the PDE for \\textit{some} initial value.\n  \t\t\\item Replace initial value problem by \\bluetext{Least Square Shadowing (LSS) problem:}\n\n  \t\t\\begin{align*}\n  \t\t\t\\only<2,3>{ \\min_{\\substack{y^i, i=0,\\dots,N \\\\ \\Delta t^i, i=1,\\dots,N}} \\quad \\frac{1}{N}\\sum_{i=0}^N \\frac 12 \\left\\Vert y^i - y^i_{r}\\right\\Vert ^2 \\,\n  \t\t\t\t\t\t\t\t\t+ \\, \\frac{\\alpha}{N} \\sum_{i=1}^N \\frac{1}{2} \\left( 1 - \\frac{\\Delta t^i}{\\Delta t_{r}^i} \\right)^2\n  \t\t  }  \\\\\n  \t\t\t\\only<2,3>{\\text{s.t.}\\quad } y^i = G^i(y^i,y^{i-1},\\Delta t^i, u) \\quad \\text{for } i=1,\\dots,N\n  \t\t\\end{align*}\n  \t\t\\only<2,3> {for a reference trajectory $y^i_r$ with time steps $\\Delta t^i_r$.}\n  \t%\\item Objective function of LSS comprises combination of two metrices}\n  \t\\only<3>{\n  \t\\item LSS problem ist well-posed % if $y_r$ is close to the solution, if PDE is quasi-hyperbolic\n\n  \t}\n  \t\\end{itemize}\n\\end{frame}\n\n\n\\begin{frame}{Solving the LSS Problem}\n\t\\begin{itemize}\n\t\t\\item KKT conditions: $y^i, i=0,\\dots,N$, $\\Delta t^i$ and $w^i, i=1,\\dots,N$ solve\n\t\t\t\\begin{align*}\n\t\t\t\t\\frac{1}{N}\\left(y^i - y^i_r\\right)  + \\left(\\partial_{y^i}G^i - Id\\right)^Tw^i + \\left(\\partial_{y^{i}}G^{i+1}\\right)^T w^{i+1} &= 0 \\quad \\text{for } i=0,\\dots,N \\\\\n\t\t\t\t\\frac{\\alpha}{N\\Delta t^i_r} \\left( 1 - \\frac{\\Delta t^i}{\\Delta t_r^i}\\right)  + \\left(\\partial_{\\Delta t^i} G^i \\right)^Tw^i &= 0 \\quad \\text{for } i=1,\\dots,N \\\\\n\t\t\t\ty^i - G^i(y^i,y^{i-1}, \\Delta t^i,u) &= 0 \\quad \\text{for } i=1,\\dots,N\n\t\t\t\\end{align*}\n\t\t\twhere $w^0 = w^{N+1} = 0$\n\t\t\\item Solve the KKT system iteratively: Quasi-Newton method\n    \\begin{align*}\n      \\begin{pmatrix} \\vec y_{k+1} \\\\ \\vec{\\Delta t}_{k+1} \\\\ \\vec{w}_{k+1} \\end{pmatrix} &= \\begin{pmatrix} \\vec y_{k} \\\\ \\vec{\\Delta t}_{k} \\\\ \\vec{w}_{k} \\end{pmatrix} +  \\begin{pmatrix} \\delta {\\vec y} \\\\ \\delta {\\vec{\\Delta t}}\\\\ \\delta {\\vec{w}} \\end{pmatrix}\n       %=: H(\\begin{pmatrix} \\vec y_{k} \\\\ \\vec{\\Delta t}_{k} \\\\ \\vec{w}_{k} \\end{pmatrix} ,u)\n    \\end{align*}\n\n\n    %\\item Exploit block-structure (Schurcomplement)\n\t\t\t%$\\rightarrow$ Dimension $O(N\\cdot M)$ \\\\\n\t\t\t%$\\rightarrow$ Multigrid approach\n\t\\end{itemize}\n\\end{frame}\n\n\\begin{frame}{Solving the LSS Problem}\n    \\begin{itemize}\n      \\item Approximate Newton update\n        \\begin{align*}\n          \\begin{pmatrix} I & 0 & B^T \\\\\n                          0 & I & C^T \\\\\n                          B & C & 0\n          \\end{pmatrix}\n          \\begin{pmatrix} \\delta {\\vec y} \\\\ \\delta {\\vec{\\Delta t}} \\\\ \\delta {\\vec{w}}  \\end{pmatrix}\n         = - \\begin{pmatrix} \\vec{R_w} \\\\ \\vec{R_{\\Delta t}} \\\\ \\vec{R_y} \\end{pmatrix}\n        \\end{align*}\n      where\n        \\begin{align*}\n          B = \\begin{pmatrix}\n          D^1   &  E^1  &       &   & \\\\\n                &  D^2  &  E^2  &   &  \\\\\n                &       & \\ddots & \\ddots & \\\\\n                &       &        & D^N    & E^N\n          \\end{pmatrix}, \\quad\n          C = \\begin{pmatrix} f^1 & & \\\\ & \\ddots & \\\\ & & f^N \\end{pmatrix}\n        \\end{align*}\n      with $D^i = \\partial_{y^{i-1}}G^i, E^i = \\partial_{y^i}G^i - I$ and $f^i = \\partial_{\\Delta t_i}G^i$\n\n      % \\begin{align*}\n      %   C &= \\begin{pmatrix}\n      %   \\partial_{y^{0}} G^1  & \\partial_{y^1} G^1 -I  &  & & \\\\\n      %   & \\partial_{y^{1}} G^2 & \\partial_{y^2} G^2 -I  &  &  \\\\\n      %   & \\hspace{1.5cm} \\ddots  & \\hspace{1.5cm} \\ddots & \\\\\n      %   &   & \\partial_{y^{N-1}} G^N & \\partial_{y^N} G^N -I\n      %   \\end{pmatrix} \\\\\n      %   D &= \\begin{pmatrix} \\partial _{\\Delta t^1} G^1 & & \\\\ & \\ddots & \\\\ & & \\partial _{\\Delta t^N} G^N \\end{pmatrix}\n      % \\end{align*}\n    \\end{itemize}\n\\end{frame}\n\n\\begin{frame}{Solving the LSS Problem}\n  \\begin{itemize}\n    \\item Solve the Schurcomplement equation for $\\vec{\\delta w}$\n      \\begin{align*}\n        \\left(B B^T + C C^T\\right) \\delta {\\vec w}  = \\vec{R_y} + B\\vec{R_w} + C \\vec{R_{\\Delta t}}\n      \\end{align*}\n    \\begin{itemize}\n      \\item Linear space-time system, can be solved in parallel $\\rightarrow$ HPC\n      \\item Exploit sparse, block tridiagonal structure\n    \\end{itemize}\n    \\item Compute the trajectory update from\n      \\begin{align*}\n       \\delta {\\vec y} &= -\\vec{R_w} - B^T \\delta \\vec w \\\\\n       \\delta {\\vec{\\Delta t}} &= -\\vec{R_{\\Delta t}} - C^T \\delta \\vec w\n     \\end{align*}\n  \\end{itemize}\n\\end{frame}\n\n\n\n%##############################################################################\n\\section{Numerical Results}\n%##############################################################################\n\\begin{frame}{Numerical Results}\n  \\begin{itemize}\n  \t\\item Advection - diffusion equation with boundary actuation\n  \t\\begin{align*}\\begin{array}{rll}\n  \t\t\t\\partial_t y + a\\partial_x y - \\mu \\partial_{xx} y &= 0 & \\forall x\\in (0,1), t>0 \\\\\n  \t \t\t y(t,0) &= z(t) & \\forall t >0\n  \t\t\t \\end{array}\n  \t\\end{align*}\n    with $a=1.0$, $\\mu = 10^{-5}$\n  \t\\item The upsteam boundary condition satisfies the Lorenz attracor with $\\sigma = 10, \\beta = \\frac 8 3$ fixed and $\\rho >0$\n\n  \\end{itemize}\n  \\begin{minipage}{0.48\\textwidth}\n    \\begin{align*}\n      \\dot x(t) &= \\sigma (y(t) - r(t)) \\\\\n      \\dot r(t) &= x(t) (\\rho - z(t)) - r(t) \\\\\n      \\dot z(t) &= x(t)r(t) - \\beta z(t)\n    \\end{align*}\n  \\end{minipage}\n  \\begin{minipage}{0.5\\textwidth}\n  \t\\begin{figure}\n      Figure of Lorenz $z$ here!\n  \t\t%\\includegraphics[width=0.8\\textwidth]{}\n  \t\\end{figure}\n  \\end{minipage}\n\\end{frame}\n\n\n\\begin{frame}{Solving LSS for Advection - Diffusion Equation}\n  Include Figures for residual for the Lorenz AD case\n  \\begin{itemize}\n    \\item Number of iterations needed for convergence is independent of time domain size.\n  \\end{itemize}\n\n\\end{frame}\n\n\n\\begin{frame}{One-shot with LSS constraints}\n  \\begin{itemize}\n    \\item Objective function and fixed point constraints\n    \\item Figure for one-shot optimization for Lorenz\n    \\item Bounded retardation factor $5$.\n  \\end{itemize}\n\\end{frame}\n\n\n\\begin{frame}{Conclusion and Outlook}\n\n\\end{frame}\n%\n%\n%\n% \\begin{frame}{References}\n% \t\\begin{thebibliography}{}\n% \t{\\small\n% \t\t\\bibitem[{\\\"O}zkaya et al., 2014] {SPPsammelband} Bosse, T., Gauger, N.R., Griewank, A., G{\\\"u}nther, S., Kaland, L., Kratzenstein, C., Lehmann, L., Nemili, A., {\\\"O}zkaya, E., Slawig, A.: Optimal Design with Bounded Retardation for Problems with Non-separable Adjoints, International Series of Numerical Mathematics, 165 pp. 67-84 (2014)\n%\n% \t\\bibitem[Gauger et al., 2008] {Gauger2008} Gauger, N., Griewank, A., Riehme, J: Extension of fixed point PDE solvers for optimal design by one-shot method: With first applications to aerodynamic shape optimization, European Journal of Computational Mechanics, 17 (1-2), pp. 87–102 (2008)\n%\n% \t%       \\bibitem[Gauger {\\&} {\\\"O}zkaya, 2010]{OezkayaGauger:2010} Gauger, N.R., {\\\"O}zkaya, E.: Automated transition from simulation to one-shot shape optimization with Navier-Stokes equations. Gamm-Mitt. \\textbf{33(2)}, 133--147, 2010\n%\n% \t       \\bibitem[Griewank, Hamdi, 2011]{HamdiGriewank:2011} Griewank, A., Hamdi, A.: Reduced quasi-{N}ewton method for simultaneous design and optimization. Comput Optim Appl.  \\textbf{49}, 521--548 (2011)\n%\n% \t%       \\bibitem[Carnarius et al., 2013]{nemili:unsteady} Carnarius, A., Thiele, F., Gauger, N.R., Nemili, A., \\\"Ozkaya, E.: Optimal Control of Unsteady Flows Using a Discrete and a Continuous Adjoint Approach. In: H\\\"omberg, D., Tr\\\"oltzsch, F. (eds): Systems Modeling and Optimization, pp. 318--327. Springer, Heidelberg (2013)\n%\n% \t \t\\bibitem[G{\\\"u}nther et al., 2015]{Eurogen} G{\\\"u}nther, S., Gauger, N.R., Wang, Q.: Extension of the One-Shot Method for Optimal Control with Unsteady PDEs, Computational Methods in Applied Sciences, Vol. 36, pp. 127-142 (2015)\n%\n% \t \t\\bibitem[G{\\\"u}nther et al., 2015]{JCAM} G{\\\"u}nther, S., Gauger, N.R., Wang, Q.: Simultaneous One-shot optimization with unsteady PDEs, arXiv preprint, arXiv:1503.00884 (2015)}\n%\n%\n% \t\\end{thebibliography}\n% \\end{frame}\n\n %====================================================================================\n% ====================================================================================\n% ====================================================================================\n\\beginbackup\n\n\n\\backupend\n\n\\end{document}\n","defaultMarkerLayerId":"0","markerLayers":{"0":{"nextMarkerId":0,"id":"0","maintainHistory":false,"markersById":{},"version":2},"1":{"nextMarkerId":0,"id":"1","maintainHistory":false,"markersById":{},"version":2},"2":{"nextMarkerId":1,"id":"2","maintainHistory":true,"markersById":{"2-0":{"range":{"start":{"row":0,"column":0},"end":{"row":0,"column":0}},"properties":{"type":"selection"},"reversed":false,"tailed":false,"valid":true,"invalidate":"never"}},"version":2}},"nextMarkerLayerId":3,"history":{"version":3,"nextCheckpointId":1,"undoStack":[],"redoStack":[]},"encoding":"utf8","filePath":"/home/sguenther/Publications/2016_03_GAMM/Presentation/guenther.tex","digestWhenLastPersisted":"dc9e317530102e1c416d4a3b0bb678847d1485d6","preferredLineEnding":null,"deserializer":"TextBuffer","version":4}]},"workspace":{"deserializer":"Workspace","paneContainer":{"deserializer":"PaneContainer","version":1,"root":{"deserializer":"Pane","id":3,"items":[{"deserializer":"TextEditor","id":88,"softTabs":true,"firstVisibleScreenRow":0,"firstVisibleScreenColumn":0,"displayBuffer":{"deserializer":"DisplayBuffer","id":89,"softWrapped":true,"tokenizedBuffer":{"deserializer":"TokenizedBuffer","bufferPath":"/home/sguenther/Publications/2016_03_GAMM/Presentation/guenther.tex","largeFileMode":false},"largeFileMode":false,"foldsMarkerLayerId":"1"},"selectionsMarkerLayerId":"2"}],"activeItemURI":"/home/sguenther/Publications/2016_03_GAMM/Presentation/guenther.tex","focused":true,"flexScale":1},"activePaneId":3},"packagesWithActiveGrammars":["language-latex","language-hyperlink","language-todo"],"destroyedItemURIs":["/home/sguenther/Templates/plot_templates/gnuplot/tikz/testing/sin.log","/home/sguenther/Templates/plot_templates/gnuplot/tikz/testing/sin.tex"]},"packageStates":{"autocomplete-bibtex":{"provider":{"deserializer":"BibtexProvider","data":{"bibtex":[],"possibleWords":[]}},"saveTime":1455041489880},"fuzzy-finder":{},"metrics":{"sessionLength":1206613},"tabs":[{"previewTabURI":"/home/sguenther/Publications/2016_03_GAMM/Presentation/guenther.tex"}],"tree-view":{"directoryExpansionStates":{"/home/sguenther/Templates/plot_templates/gnuplot/tikz/testing":{"isExpanded":true,"entries":{}}},"hasFocus":false,"attached":true,"scrollLeft":0,"scrollTop":0,"width":200}},"fullScreen":false}